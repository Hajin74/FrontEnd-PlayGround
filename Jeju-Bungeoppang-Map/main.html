<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="./images/bungeoppang-icon.png">
    <meta name="Keywords" content="ì œì£¼ë„ ë¶•ì–´ë¹µ ì§€ë„, ë¶•ì–´ë¹µ, ì œì£¼ë„, ì§€ë„, ê²¨ìš¸, ê°„ì‹, íŒ¥ë¶•, ìŠˆë¶•" />
    <link rel="stylesheet" href="./css/main.css">
    <title>ì œì£¼ë„ ë¶•ì–´ë¹µ ì§€ë„</title>
</head>
<body>
<div id="map-container">

     <div id="map-navbar">
        <h1 id="map-title">ì œì£¼ë„ ë¶•ì–´ë¹µ ì§€ë„</h1>
        <p id="developer-email">ê°œë°œì ì´ë©”ì¼ : yoonmij9974@naver.com</p>
    </div>


    <div id="map-main">
        <!-- api í‚¤ -->
        <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey={API_KEY}&libraries=services"></script>

        <!-- json íŒŒì¼ ì½ì–´ì˜¤ê¸° -->
        <script type="text/javascript" src="./data/locations.json"></script>
        <script>
            var locationData = JSON.parse(JSON.stringify(Params))["locations"];
        </script>
        
        <script>
          // ì¸í¬ìœˆë„ìš°ë¥¼ í‘œì‹œí•˜ëŠ” í´ë¡œì €ë¥¼ ë§Œë“œëŠ” í•¨ìˆ˜
          function makeOverListener(map, marker, infowindow) {
              return function() {
                  infowindow.open(map, marker);
              };
          }
        </script>

        <!-- ì§€ë„ ë„ìš°ê¸° -->
        <script>
            var mapContainer = document.getElementById('map-main');
            var mapOption = { 
                center: new kakao.maps.LatLng(locationData[0]["lat"], locationData[0]["lng"]),
                level: 7
            };
            var map = new kakao.maps.Map(mapContainer, mapOption);
        </script>
                
        <!-- ì§€ë„ í™•ëŒ€ ì¶•ì†Œ ì œì–´í•˜ê¸° -->
        <script>
            var zoomControl = new kakao.maps.ZoomControl();
            map.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT);
        </script>

        <!-- ì—¬ëŸ¬ ê°œì˜ ë§ˆì»¤ ì°ê¸° + ì¸í¬ìœˆë„ìš° ë„ìš°ê¸° -->
        <script>
            for (var i = 0; i < locationData.length; i++) {
                var marker = new kakao.maps.Marker({
                    map: map,
                    title: locationData[i]["title"],
                    position: new kakao.maps.LatLng(locationData[i]["lat"], locationData[i]["lng"])
                });
               
                (function (index) {
                    var geocoder = new kakao.maps.services.Geocoder();
                    var coord = new kakao.maps.LatLng(locationData[index]["lat"], locationData[index]["lng"]);
                    
                    var callback = function (result, status) {
                        if (status === kakao.maps.services.Status.OK) {
                            var iwContent = `
                                <div class="overlay-wrapper">
                                  <p class="shop-name">${locationData[index]["title"]}</p>
                                  <a class="shop-map-detail" href="https://map.kakao.com/link/map/${result[0].address.address_name},${locationData[index]["lat"]},${locationData[index]["lng"]}" style="color:blue; text-decoration: none;">ğŸ“ì¹´ì¹´ì˜¤ë§µìœ¼ë¡œ ë³´ê¸°</a> 
                                </div>
                            `;
                            var iwPosition = new kakao.maps.LatLng(locationData[index]["lat"], locationData[index]["lng"]);
                            var iwRemoveable = true;

                            var infowindow = new kakao.maps.InfoWindow({
                                map: map,
                                content: iwContent,
                                position : iwPosition, 
                                removable : iwRemoveable
                            });
                            
                        }
                    };
                    
                    geocoder.coord2Address(coord.getLng(), coord.getLat(), callback);
                })(i);
            }
        </script>
    </div>
</div>
</body>
</html>